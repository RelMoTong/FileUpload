# 图片异步上传工具 v1.8 - 快速使用指南

## 🎉 欢迎使用！

这是一个功能强大的图片异步上传工具，支持未登录状态快速使用，也提供完整的权限管理系统。

---

## 🚀 快速开始（无需登录）

### 1. 启动程序
双击 `图片异步上传工具_v1.8.exe`

### 2. 选择源文件夹
点击"源文件夹"旁的**"浏览"**按钮，选择要上传的图片文件夹

### 3. 查看默认配置
- 目标文件夹：（显示默认路径）
- 备份文件夹：（显示默认路径）
- 上传间隔：30秒
- 文件类型：JPG, PNG, BMP, TIFF, GIF, RAW

### 4. 开始上传
点击绿色的**"▶ 开始上传"**按钮

### 5. 查看进度
在右侧"运行状态"卡片中查看：
- 上传进度百分比
- 当前上传文件名
- 上传速度（MB/s）
- 已上传/失败/跳过的文件数

### 6. 控制上传
- **暂停**：点击"⏸ 暂停上传"
- **继续**：点击"▶ 继续上传"
- **停止**：点击"⏹ 停止上传"

---

## 🔑 登录使用（完整功能）

### 用户登录
1. 点击右上角"权限登录"（或菜单栏的"更多" → "权限登录"）
2. 选择"👤 用户"
3. 输入密码：`123`
4. 点击"确定"

### 管理员登录
1. 点击右上角"权限登录"
2. 选择"👑 管理员"
3. 输入密码：`Tops123`
4. 点击"确定"

### 登录后可以做什么
- ✅ 修改目标文件夹路径
- ✅ 修改备份文件夹路径
- ✅ 调整上传间隔（10-3600秒）
- ✅ 设置磁盘阈值（5-50%）
- ✅ 设置失败重试次数（0-10次）
- ✅ 调整磁盘检查间隔（1-60秒）
- ✅ 选择文件类型过滤
- ✅ 设置开机自启动
- ✅ 设置启动时自动运行
- ✅ 保存所有配置

---

## ⚙️ 主要功能说明

### 📁 文件夹设置
| 文件夹 | 未登录 | 已登录 | 说明 |
|--------|--------|--------|------|
| **源文件夹** | ✅ 可选择 | ✅ 可选择 | 要上传的图片所在位置 |
| **目标文件夹** | ❌ 只读 | ✅ 可修改 | 图片上传的目标位置 |
| **备份文件夹** | ❌ 只读 | ✅ 可修改 | 上传成功后移动备份的位置 |

### ⚙️ 上传设置
- **间隔时间**：每次扫描源文件夹的时间间隔
- **磁盘阈值**：目标磁盘剩余空间低于此值时停止上传
- **失败重试次数**：上传失败后自动重试的次数（递增等待：10s→30s→60s）
- **磁盘检查间隔**：更新磁盘空间显示的频率
- **文件类型限制**：只上传选中的图片格式

### 🎮 操作控制
- **▶ 开始上传**：启动上传任务（所有人可用）
- **⏸ 暂停上传**：暂停正在进行的上传
- **⏹ 停止上传**：完全停止上传任务

### 📊 运行状态
实时显示：
- 上传进度条（百分比 + 文件名）
- 运行时间
- 上传统计（已上传/失败/跳过）
- 上传速度（MB/s）
- 目标磁盘剩余空间（动态颜色）
  - 🔵 蓝绿色：> 30%
  - 🟡 黄色：10-30%
  - 🔴 红色：< 10%
- 归档磁盘剩余空间

### 📜 运行日志
- 详细记录每一步操作
- 支持自动滚动（可锁定）
- 支持清空日志
- 日志保存到 `logs/` 目录

---

## 🎯 典型使用场景

### 场景1：快速测试（无需登录）
```
目的：快速测试上传功能是否正常

步骤：
1. 启动程序
2. 选择源文件夹（如：D:\Photos\待上传）
3. 点击"开始上传"
4. 观察日志和进度
```

### 场景2：完整配置（需要登录）
```
目的：配置所有路径和参数

步骤：
1. 启动程序
2. 点击"权限登录"，输入密码
3. 修改目标文件夹（如：Y:\上传目标）
4. 修改备份文件夹（如：D:\备份）
5. 调整上传间隔（如：60秒）
6. 点击"保存配置"
7. 点击"开始上传"
```

### 场景3：自动化运行
```
目的：开机自动上传

步骤：
1. 登录程序（用户或管理员）
2. 配置好所有路径和参数
3. 勾选"🚀 开机自启动"
4. 勾选"▶ 启动时自动运行"
5. 保存配置
6. 下次开机程序会自动启动并开始上传
```

---

## ⚠️ 重要提示

### 路径验证
开始上传前，程序会自动验证路径：
- ✅ 路径必须存在
- ✅ 路径不能为空
- ❌ 如果验证失败，会弹窗显示详细错误

### 配置修改确认
如果修改了路径但未保存：
- 点击"开始上传"时会弹出确认对话框
- **选择"是"**：保存新配置并使用新路径上传
- **选择"否"**：放弃修改，使用已保存的配置上传
- **选择"取消"**：取消本次上传

### 运行中限制
上传运行时：
- ❌ 无法修改任何路径
- ❌ 无法修改任何设置
- ✅ 可以暂停/继续/停止
- 停止后才能修改配置

---

## 🔍 状态指示器说明

### 角色标签（右上角）
- 🔒 未登录（黄色）
- 👤 用户（蓝色）
- 👑 管理员（紫色）

### 运行状态芯片
- ⏸ 已停止（灰色）
- ▶ 运行中（绿色）
- ⏸ 已暂停（橙色）

### 磁盘空间芯片
- 🔵 蓝绿色：充足（> 30%）
- 🟡 黄色：警告（10-30%）
- 🔴 红色：危险（< 10%）

---

## 📝 配置文件

程序会在当前目录自动创建 `config.json`：

```json
{
  "source_folder": "D:/source",
  "target_folder": "Y:/target",
  "backup_folder": "D:/backup",
  "upload_interval": 30,
  "disk_threshold_percent": 10,
  "retry_count": 3,
  "disk_check_interval": 5,
  "filter_jpg": true,
  "filter_png": true,
  "auto_start_windows": false,
  "auto_run_on_startup": false
}
```

---

## 🐛 常见问题

### Q1: 提示"路径不存在"
**原因**：配置的文件夹路径不存在

**解决**：
1. 先创建文件夹
2. 然后在程序中配置路径

### Q2: 无法修改目标文件夹
**原因**：未登录状态

**解决**：
1. 点击"权限登录"
2. 输入密码登录后即可修改

### Q3: 配置修改后没有保存
**原因**：未点击"保存配置"

**解决**：
1. 修改配置后点击"保存配置"
2. 或在开始上传时选择"是"保存

### Q4: 上传速度很慢
**可能原因**：
1. 网络带宽限制
2. 目标磁盘写入速度慢
3. 上传间隔设置太长

**解决**：
1. 检查网络连接
2. 检查目标磁盘性能
3. 减小上传间隔时间

### Q5: 磁盘空间显示不更新
**原因**：磁盘检查间隔设置太长

**解决**：
1. 登录程序
2. 将"磁盘检查间隔"改为更小的值（如1-5秒）
3. 保存配置

---

## 🎨 界面布局

```
┌────────────────────────────────────────────────────────┐
│ [Logo] 图片异步上传工具 v2 (PyQt)          🔒 未登录    │
├────────────────────────────────────────────────────────┤
│                                                        │
│  📁 文件夹设置              🎮 操作控制                │
│  ├─ 源文件夹 [浏览]         ├─ ▶ 开始上传              │
│  ├─ 目标文件夹 [浏览]       ├─ ⏸ 暂停上传              │
│  └─ 备份文件夹 [浏览]       └─ ⏹ 停止上传              │
│                                                        │
│  ⚙️ 上传设置                📊 运行状态                │
│  ├─ 间隔时间: 30秒          ├─ 进度条: 65%             │
│  ├─ 磁盘阈值: 10%           ├─ 运行时间: 00:05:23      │
│  ├─ 重试次数: 3次           ├─ 已上传: 45              │
│  ├─ 磁盘检查: 5秒           ├─ 速度: 2.5 MB/s          │
│  ├─ 文件类型: ☑JPG ☑PNG    ├─ 目标磁盘: 45.2%         │
│  ├─ 🚀 开机自启动           └─ 归档磁盘: 62.8%         │
│  └─ ▶ 启动时自动运行                                   │
│                                                        │
├────────────────────────────────────────────────────────┤
│  📜 运行日志                                           │
│  ├─ 🔍 正在验证文件夹路径...                           │
│  ├─ ✓ 所有路径验证通过                                 │
│  ├─ 🚀 准备开始上传任务...                             │
│  ├─ ✓ 上传任务已启动                                   │
│  └─ 📤 正在上传: photo_001.jpg                         │
└────────────────────────────────────────────────────────┘
```

---

## 🔗 快捷键

目前程序未实现快捷键，所有操作通过鼠标点击完成。

---

## 📞 技术支持

如遇问题，请查看：
1. **日志文件**：`logs/` 目录下的日志文件
2. **配置文件**：`config.json`
3. **更新日志**：`更新日志_v1.8.md`

---

## ✨ 特色功能

1. **无需登录即可使用** - 降低使用门槛
2. **智能权限管理** - 保护敏感配置
3. **路径验证** - 防止配置错误
4. **配置确认对话框** - 防止误操作
5. **实时磁盘监控** - 避免磁盘空间不足
6. **失败自动重试** - 提高上传成功率
7. **详细日志记录** - 便于问题排查
8. **开机自启动** - 实现无人值守

---

**版本**: v1.8  
**更新日期**: 2025-10-22  
**程序大小**: 238.55 MB  
**使用方式**: 免安装，双击即用
